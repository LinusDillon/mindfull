<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Mindful</title>
	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css" />
	<script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
	<script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
	<style>
		.footer-button-left,
		.footer-button-right {
			position: absolute;
			margin: 0;
			top: auto;
			bottom: 0.24em;
		}
		.footer-button-left {
			left: 0.4em;
		}
		.footer-button-right {
			right: 0.4em;
		}
	</style>
</head>


<body>

<!-- Start of first page: #one -->
<div data-role="page" id="one">

	<div data-role="header" data-position="fixed">
		<h1>Mindful</h1>
	</div><!-- /header -->

	<div data-role="content" >
		<p>Add, modify and remove prompts in the list below.</p>

		<ul data-role="listview" data-inset="true">
			<li><a href="#two">
				<h2>Get up and strech!</h2>
				<p>Up to 5 each weekday between 8am and 5pm if no activity within last hour</p>
			</a></li>
		</ul>
		<p><a href="#two" data-role="button">Add a new prompt</a></p>
	</div><!-- /content -->

	<div data-role="footer" role="contentinfo" class="ui-footer ui-bar-inherit" data-position="fixed">
		<h1>&nbsp;</h1>
		<a href="#" id="b-cancel" class="footer-button-left ui-btn ui-icon-delete ui-btn-icon-left ui-btn-inline ui-corner-all" data-role="button" role="button">Cancel</a>
		<a href="#" id="b-save" class="footer-button-right ui-btn ui-icon-check ui-btn-icon-right ui-btn-inline ui-corner-all" data-role="button" role="button">Save</a>
	</div><!-- /footer -->
</div><!-- /page one -->


<!-- Start of second page: #two -->
<div data-role="page" id="two">

	<div data-role="header" data-add-back-btn="true" data-position="fixed">
		<h1>Mindful</h1>
	</div><!-- /header -->

	<div data-role="content">

		<label for="startTime" id="range-1a-label">Time Range:</label>
		<div data-role="rangeslider" class="ui-rangeslider">
      <input type="number" data-type="range" name="startTime" id="range-1a" min="0" max="23" value="8" class="ui-shadow-inset ui-corner-all ui-slider-input ui-rangeslider-first ui-body-inherit">
      <input type="number" data-type="range" name="endTime" id="range-1b" min="0" max="23" value="18" class="ui-shadow-inset ui-corner-all ui-slider-input ui-rangeslider-last ui-body-inherit">
		</div>

		<fieldset data-role="controlgroup" data-type="horizontal" class="ui-controlgroup ui-controlgroup-horizontal ui-corner-all ui-mini">
			<div role="heading" class="ui-controlgroup-label"><legend>Days:</legend></div>
			<div class="ui-controlgroup-controls ">
				<div class="ui-checkbox ui-mini"><label for="dayMon" class="ui-btn ui-corner-all ui-btn-inherit ui-first-child ui-btn-active ui-checkbox-on">Mo</label><input type="checkbox" name="dayMon" id="dayMon" checked="checked"></div>
				<div class="ui-checkbox ui-mini"><label for="dayTue" class="ui-btn ui-corner-all ui-btn-inherit ui-checkbox-on">Tu</label><input type="checkbox" name="dayTue" id="dayTue" checked="checked"></div>
				<div class="ui-checkbox ui-mini"><label for="dayWed" class="ui-btn ui-corner-all ui-btn-inherit ui-checkbox-on">We</label><input type="checkbox" name="dayWed" id="dayWed" checked="checked"></div>
				<div class="ui-checkbox ui-mini"><label for="dayThu" class="ui-btn ui-corner-all ui-btn-inherit ui-checkbox-on">Th</label><input type="checkbox" name="dayThu" id="dayThu" checked="checked"></div>
				<div class="ui-checkbox ui-mini"><label for="dayFri" class="ui-btn ui-corner-all ui-btn-inherit ui-checkbox-on">Fr</label><input type="checkbox" name="dayFri" id="dayFri" checked="checked"></div>
				<div class="ui-checkbox ui-mini"><label for="daySat" class="ui-btn ui-corner-all ui-btn-inherit ui-checkbox-off">Sa</label><input type="checkbox" name="daySat" id="daySat"></div>
				<div class="ui-checkbox ui-mini"><label for="daySun" class="ui-btn ui-corner-all ui-btn-inherit ui-last-child ui-btn-active ui-checkbox-off">Su</label><input type="checkbox" name="daySun" id="daySun"></div>
		  </div>
		</fieldset>

	<label for="enabled">Active:</label>
	<select name="enabled" id="enabled" data-role="slider">
		<option value="0">Off</option>
		<option value="1" selected>On</option>
	</select>

	<label for="frequency">Frequency:</label>
	<select name="enabled" id="enabled">
		<option value="0">About every hour</option>
		<option value="1">About an hour after last activity</option>
		<option value="2">About every two hours</option>
		<option value="3">About every four hours</option>
		<option value="4">Twice a day</option>
		<option value="5" selected>Once a day</option>
		<option value="6">Every two days</option>
		<option value="7">Twice a week</option>
		<option value="8">Once a week</option>
		<option value="9">Once a fortnight</option>
		<option value="10">Once a month</option>
		<option value="11">Once a quarter</option>
		<option value="12">Twice a year</option>
		<option value="13">Once a year</option>
	</select>

	<label for="msg1">Messages:</label>
	<ul data-role="listview" data-inset="true" data-split-icon="delete">
		<li>
			<a href="#"><input type="text" name="msg1"></a>
			<a href="#">Delete</a>
		</li>
		<li>
			<a href="#" class="ui-btn">Add message</a>
		</li>
	</ul>

	</div><!-- /content -->

</div><!-- /page two -->

<script>
function saveOptions() {
	var options = {}
	//Add all textual values
	$('textarea, select, [type="hidden"], [type="password"], [type="text"]').each(function(){options[$(this).attr('name')] = $(this).val();})
	//Add all checkbox type values
	$('[type="radio"], [type="checkbox"]').each(function(){options[$(this).attr('name')] = $(this).is(':checked');})
	return options;
}

$().ready(function() {
	$("#b-cancel").click(function() {
		console.log("Cancel");
		document.location = "pebblejs://close";
	});

	$("#b-save").click(function() {
		console.log("Save");
		var location = "pebblejs://close#" + encodeURIComponent(JSON.stringify(saveOptions()));
		console.log("Warping to: " + location);
		console.log(location);
		document.location = location;
	});

	//Set form values to whatever is passed in.
	var obj = jQuery.parseJSON(decodeURIComponent(window.location.search.substring(1)));
	console.log(obj);
	for(key in obj) {
		var target = $("[name='" + key + "']");
		target.val(obj[key]);
	}
});
</script>

</body>
</html>
